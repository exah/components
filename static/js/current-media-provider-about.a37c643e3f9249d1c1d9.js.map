{"version":3,"sources":["webpack:///./src/box/index.js","webpack:///./src/current-media-provider/about.mdx","webpack:///./src/current-media-provider/index.js","webpack:///./src/utils.js"],"names":["BorderBox","Object","_emotion_styled_base__WEBPACK_IMPORTED_MODULE_0__","Base","target","props","css","displayName","propTypes","assign","Box","system","MDXContent","_this","_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__","this","_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3__","_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4__","call","layout","_this$props","components","_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_6___default","a","createElement","_mdx_js_tag__WEBPACK_IMPORTED_MODULE_7__","name","id","parentName","className","docz__WEBPACK_IMPORTED_MODULE_8__","__position","__code","__scope","CurrentMediaProvider","CurrentMediaConsumer","_index__WEBPACK_IMPORTED_MODULE_9__","media","mobile","desktop","state","_box__WEBPACK_IMPORTED_MODULE_10__","currentMediaKey","React","Component","listenForChanges","fn","addListener","removeListener","INITIAL_STATE","Context","createContext","Provider","Consumer","updateCurrentMedia","key","mql","matches","concat","_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__","filter","item","CurrentMediaProviderWithTheme","withTheme","_ref","_ref$theme","theme","_ref$media","children","_useState","useState","_useState2","_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__","setCurrentMedia","useLayoutEffect","listeners","reduceObj","acc","query","window","matchMedia","map","react__WEBPACK_IMPORTED_MODULE_2___default","value","withCurrentMedia","Comp","withDisplayName","mapProps","react__WEBPACK_IMPORTED_MODULE_1___default","defaultProps","data","isFn","withProps","withPropTypes","useIsMounted","isMounted","setIsMounted","useEffect","groupArr","items","arguments","length","undefined","reduce","index","Math","floor","push","initArr"],"mappings":"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","file":"static/js/current-media-provider-about.90dccc94.js","sourcesContent":["import styled from '@emotion/styled'\nimport { system } from 'pss'\nimport { Base } from '../base'\n\nconst BorderBox = styled(Base)(\n  { boxSizing: 'border-box' },\n  (props) => props.css\n)\n\nBorderBox.displayName = 'BorderBox'\nBorderBox.propTypes = { ...Base.propTypes }\n\nconst Box = styled(BorderBox)(system)\n\nBox.displayName = 'Box'\nBox.propTypes = { ...BorderBox.propTypes, ...system.propTypes }\n\nexport {\n  Box,\n  BorderBox\n}\n","\n  import React from 'react'\n  import { MDXTag } from '@mdx-js/tag'\n  import { Playground } from 'docz'\nimport { CurrentMediaProvider, CurrentMediaConsumer } from './index'\nimport { Box } from '../box'\n\nexport default class MDXContent extends React.Component {\n  constructor(props) {\n    super(props)\n    this.layout = null\n  }\n  render() {\n    const { components, ...props } = this.props\n\n    return <MDXTag\n             name=\"wrapper\"\n             \n             components={components}>\n<MDXTag name=\"h1\" components={components} props={{\"id\":\"currentmediaprovider\"}}>{`CurrentMediaProvider`}</MDXTag>\n<MDXTag name=\"h2\" components={components} props={{\"id\":\"description\"}}>{`Description`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`Watch `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`media`}</MDXTag>{` defined in `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`theme`}</MDXTag>{` for changes and pass currently active media as `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`currentMediaKey`}</MDXTag>{` prop.`}</MDXTag>\n<MDXTag name=\"h2\" components={components} props={{\"id\":\"usage\"}}>{`Usage`}</MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"language-js\"}}>{`import { CurrentMediaProvider, CurrentMediaConsumer, withCurrentMedia } from 'pss-components'\n`}</MDXTag></MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"language-js\"}}>{`import { ThemeProvider } from 'emotion-theming'\n\n<ThemeProvider theme={{ media: { sm: '(max-width: 600px)' } }}>\n  <CurrentMediaProvider>\n    {/* components */}\n  </CurrentMediaProvider>\n</ThemeProvider>\n`}</MDXTag></MDXTag>\n<MDXTag name=\"pre\" components={components}><MDXTag name=\"code\" components={components} parentName=\"pre\" props={{\"className\":\"language-js\"}}>{`import { withCurrentMedia } from 'pss-components'\n\nconst MediaComponent = withCurrentMedia(Component)\n`}</MDXTag></MDXTag>\n<MDXTag name=\"h2\" components={components} props={{\"id\":\"examples\"}}>{`Examples`}</MDXTag>\n<MDXTag name=\"p\" components={components}>{`With values from `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`media`}</MDXTag>{` prop:`}</MDXTag>\n<Playground __position={0} __code={'<CurrentMediaProvider\\n  media={{ mobile: \\'(max-width: 600px)\\', desktop: \\'(min-width: 601px)\\' }}\\n>\\n  <CurrentMediaConsumer>\\n    {state => <Box>Current media: {state.currentMediaKey}</Box>}\\n  </CurrentMediaConsumer>\\n</CurrentMediaProvider>'} __scope={{props: this ? this.props : props,CurrentMediaProvider,CurrentMediaConsumer,Box}}>\n  <CurrentMediaProvider media={{ mobile: '(max-width: 600px)', desktop: '(min-width: 601px)' }}>\n    <CurrentMediaConsumer>\n      {(state) => (\n        <Box>\n          Current media: {state.currentMediaKey}\n        </Box>\n      )}\n    </CurrentMediaConsumer>\n  </CurrentMediaProvider>\n</Playground>\n<MDXTag name=\"p\" components={components}>{`From `}<MDXTag name=\"inlineCode\" components={components} parentName=\"p\">{`theme`}</MDXTag>{`:`}</MDXTag>\n<Playground __position={1} __code={'<CurrentMediaProvider>\\n  <CurrentMediaConsumer>\\n    {state => <Box>Current media: {state.currentMediaKey}</Box>}\\n  </CurrentMediaConsumer>\\n</CurrentMediaProvider>'} __scope={{props: this ? this.props : props,CurrentMediaProvider,CurrentMediaConsumer,Box}}>\n  <CurrentMediaProvider>\n    <CurrentMediaConsumer>\n      {(state) => (\n        <Box>\n          Current media: {state.currentMediaKey}\n        </Box>\n      )}\n    </CurrentMediaConsumer>\n  </CurrentMediaProvider>\n</Playground>\n           </MDXTag>\n  }\n}\n  ","import PropTypes from 'prop-types'\nimport React, { createContext, useLayoutEffect, useState } from 'react'\nimport { withTheme } from 'emotion-theming'\nimport { reduceObj } from '@exah/utils'\nimport { withDisplayName } from '../utils'\n\nconst listenForChanges = (target, fn) => {\n  fn()\n\n  target.addListener(fn)\n  return () => target.removeListener(fn)\n}\n\nconst INITIAL_STATE = {\n  currentMediaKey: []\n}\n\nconst Context = createContext(INITIAL_STATE)\nconst { Provider, Consumer } = Context\n\nconst updateCurrentMedia = (key, mql) => (currentMediaKey) => {\n  if (mql.matches) {\n    return [ ...currentMediaKey, key ]\n  }\n\n  return currentMediaKey.filter((item) => item !== key)\n}\n\nfunction CurrentMediaProvider ({\n  theme = {},\n  media = theme.media || {},\n  children\n}) {\n  const [ currentMediaKey, setCurrentMedia ] = useState(INITIAL_STATE.currentMediaKey)\n\n  useLayoutEffect(() => {\n    const listeners = reduceObj((acc, key, query) => {\n      const mql = window.matchMedia(query)\n      const listener = () => setCurrentMedia(updateCurrentMedia(key, mql))\n\n      return [ ...acc, listenForChanges(mql, listener) ]\n    }, [])(media || {})\n\n    return () => listeners.map((fn) => fn())\n  }, [ media ])\n\n  return (\n    <Provider value={{ currentMediaKey }}>\n      {children}\n    </Provider>\n  )\n}\n\nCurrentMediaProvider.propTypes = {\n  theme: PropTypes.shape({ media: PropTypes.object }),\n  media: PropTypes.object\n}\n\nconst CurrentMediaProviderWithTheme = withTheme(CurrentMediaProvider)\n\nconst withCurrentMedia = (Comp) => {\n  const HOC = (props) => (\n    <Consumer>\n      {(state) => <Comp {...state} {...props} />}\n    </Consumer>\n  )\n\n  return withDisplayName(`withCurrentMedia(${Comp.displayName || 'Component'})`)(HOC)\n}\n\nexport {\n  Context as CurrentMediaContext,\n  CurrentMediaProviderWithTheme as CurrentMediaProvider,\n  Consumer as CurrentMediaConsumer,\n  withCurrentMedia\n}\n","import React, { useEffect, useState } from 'react'\nimport { isFn, initArr } from '@exah/utils'\n\nconst mapProps = (fn) => (Comp) => (props) => (\n  <Comp {...fn(props)} />\n)\n\nconst defaultProps = (data) => mapProps((props) => ({\n  ...isFn(data) ? data(props) : data,\n  ...props\n}))\n\nconst withProps = (data) => mapProps((props) => ({\n  ...props,\n  ...isFn(data) ? data(props) : data\n}))\n\nconst withDisplayName = (name) => (Comp) => Object.assign(Comp, {\n  displayName: name\n})\n\nconst withPropTypes = (Base) => (Comp) => Object.assign(Comp, {\n  propTypes: { ...Base.propTypes }\n})\n\nfunction useIsMounted () {\n  const [ isMounted, setIsMounted ] = useState(false)\n\n  useEffect(() => setIsMounted(true), [])\n\n  return isMounted\n}\n\nconst groupArr = (items = [], length = 3) =>\n  items.reduce((target, value, index) => {\n    const key = Math.floor(index % length)\n\n    if (target[key]) {\n      target[key].push(value)\n    }\n\n    return target\n  }, initArr(length, () => []))\n\nexport {\n  mapProps,\n  defaultProps,\n  withProps,\n  withPropTypes,\n  withDisplayName,\n  useIsMounted,\n  groupArr\n}\n"],"sourceRoot":""}